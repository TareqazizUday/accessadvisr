{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Contact Us - AccessAdvisr</title>
	<link rel="stylesheet" href="{% static 'css/accessadvisr-style.css' %}">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
</head>
<body>
	
<!-- include navbar -->
{% include 'components/navbar.html' %}

<!-- include authentication modals -->
{% include 'components/auth_modals.html' %}

<!---------- location card section ---------->
{% include 'components/location_card.html' %}

<!-------- contact form section ---------->
<section class="contact-section py-5">
    <div class="container">
        <div class="row g-4 align-items-stretch">
            
            <div class="col-lg-6">
                <form id="contactForm" method="POST" class="p-4 border rounded bg-white shadow-sm h-100">
                    {% csrf_token %}
                    
                    <!-- Success Message -->
                    <div id="successMessage" class="alert alert-success d-none" role="alert">
                        <i class="bi bi-check-circle-fill me-2"></i>
                        <span id="successText"></span>
                    </div>
                    
                    <!-- Error Message -->
                    <div id="errorMessage" class="alert alert-danger d-none" role="alert">
                        <i class="bi bi-exclamation-circle-fill me-2"></i>
                        <span id="errorText"></span>
                    </div>
                    
                    <div class="mb-3 text-start">
                        <label for="userName" class="form-label fw-bold text-secondary">Name: <span class="text-danger">*</span></label>
                        <input type="text" class="form-control form-control-lg custom-input" id="userName" name="name" placeholder="Name" required>
                    </div>
                    
                    <div class="mb-3 text-start">
                        <label for="userEmail" class="form-label fw-bold text-secondary">Email: <span class="text-danger">*</span></label>
                        <input type="email" class="form-control form-control-lg custom-input" id="userEmail" name="email" placeholder="Email" required>
                    </div>
                    
                    <div class="mb-4 text-start">
                        <label for="userMessage" class="form-label fw-bold text-secondary">Message: <span class="text-danger">*</span></label>
                        <textarea class="form-control custom-input" id="userMessage" name="message" rows="5" placeholder="Message" required></textarea>
                    </div>
                    
                    <div class="text-start">
                        <button type="submit" class="btn btn-orange" id="submitBtn">
                            Send Request
                        </button>
                    </div>
                </form>
            </div>

            <div class="col-lg-6">
                <div class="map-container h-100 border rounded shadow-sm overflow-hidden">
                    <iframe 
                        src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d2483.540424380277!2d-0.12209082337190391!3d51.503324071812!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x487604b900d26973%3A0x4291f3172409ea92!2slastminute.com%20London%20Eye!5e0!3m2!1sen!2suk!4v1700000000000!5m2!1sen!2suk" 
                        width="100%" 
                        height="100%" 
                        style="border:0; min-height: 400px;" 
                        allowfullscreen="" 
                        loading="lazy" 
                        referrerpolicy="no-referrer-when-downgrade">
                    </iframe>
                </div>
            </div>

        </div>
    </div>
</section>
<!---------- footer section ---------->
{% include 'components/footer.html' %}

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>	
<script src="{% static 'js/accessadvisr-script.js' %}"></script>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const contactForm = document.getElementById('contactForm');
    const submitBtn = document.getElementById('submitBtn');
    const successMessage = document.getElementById('successMessage');
    const errorMessage = document.getElementById('errorMessage');
    const successText = document.getElementById('successText');
    const errorText = document.getElementById('errorText');
    
    contactForm.addEventListener('submit', async function(e) {
        e.preventDefault();
        
        // Disable submit button
        const originalText = submitBtn.textContent;
        submitBtn.disabled = true;
        submitBtn.innerHTML = '<span class="spinner-border spinner-border-sm me-2"></span>Sending...';
        
        // Hide previous messages
        successMessage.classList.add('d-none');
        errorMessage.classList.add('d-none');
        
        // Get form data
        const formData = new FormData(contactForm);
        
        try {
            const response = await fetch('{% url "contact" %}', {
                method: 'POST',
                body: formData,
                headers: {
                    'X-Requested-With': 'XMLHttpRequest',
                }
            });
            
            const data = await response.json();
            
            if (response.ok && data.success) {
                // Show success message
                successText.textContent = data.message;
                successMessage.classList.remove('d-none');
                
                // Reset form
                contactForm.reset();
                
                // Scroll to success message
                successMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
                
                // Hide success message after 5 seconds
                setTimeout(() => {
                    successMessage.classList.add('d-none');
                }, 5000);
            } else {
                // Show error message
                errorText.textContent = data.error || 'An error occurred. Please try again.';
                errorMessage.classList.remove('d-none');
                
                // Scroll to error message
                errorMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }
        } catch (error) {
            console.error('Error:', error);
            errorText.textContent = 'Network error. Please check your connection and try again.';
            errorMessage.classList.remove('d-none');
            
            // Scroll to error message
            errorMessage.scrollIntoView({ behavior: 'smooth', block: 'center' });
        } finally {
            // Re-enable submit button
            submitBtn.disabled = false;
            submitBtn.textContent = originalText;
        }
    });
});
</script>

</body>
</html>

